#–ì–∞–π–¥–∏–Ω –ê—Ä—Ç—ë–º –∏ –∫–æ–º–ø–∞–Ω–æ–≤–∫–∞

from ui_main import main_menu
from database import (
    add_student,
    get_all_courses,
    add_enrollment,
    set_grade,
    get_student_performance,
)


def cli_menu():
    while True:
        print("\nüéì –ê–ö–ê–î–ï–ú–ò–Ø ‚Äî –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é")
        print("1. –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞")
        print("2. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫—É—Ä—Å—ã")
        print("3. –ó–∞–ø–∏—Å–∞—Ç—å –Ω–∞ –∫—É—Ä—Å")
        print("4. –ü–æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É")
        print("5. –ü–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏")
        print("6. –í—ã–π—Ç–∏")

        –≤—ã–±–æ—Ä = input("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: ").strip()

        if –≤—ã–±–æ—Ä == "1":
            –∏–º—è = input("–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞: ").strip()
            email = input("–í–≤–µ–¥–∏—Ç–µ email —Å—Ç—É–¥–µ–Ω—Ç–∞: ").strip()
            try:
                add_student(–∏–º—è, email)
                print(f"‚úÖ –°—Ç—É–¥–µ–Ω—Ç {–∏–º—è} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω.")
            except ValueError as e:
                print(f"‚ùå –û—à–∏–±–∫–∞: {e}")

        elif –≤—ã–±–æ—Ä == "2":
            –∫—É—Ä—Å—ã = get_all_courses()
            print("\nüìö –°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤:")
            for –∫—É—Ä—Å in –∫—É—Ä—Å—ã:
                print(f"ID: {–∫—É—Ä—Å[0]}, –ù–∞–∑–≤–∞–Ω–∏–µ: {–∫—É—Ä—Å[1]}, –û–ø–∏—Å–∞–Ω–∏–µ: {–∫—É—Ä—Å[2]}")

        elif –≤—ã–±–æ—Ä == "3":
            try:
                student_id = int(input("–í–≤–µ–¥–∏—Ç–µ ID —Å—Ç—É–¥–µ–Ω—Ç–∞: "))
                course_id = int(input("–í–≤–µ–¥–∏—Ç–µ ID –∫—É—Ä—Å–∞: "))
                add_enrollment(student_id, course_id)
                print(f"‚úÖ –°—Ç—É–¥–µ–Ω—Ç —Å ID {student_id} –∑–∞–ø–∏—Å–∞–Ω –Ω–∞ –∫—É—Ä—Å —Å ID {course_id}.")
            except ValueError as e:
                print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
            except Exception as e:
                print(f"‚ö†Ô∏è –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")

        elif –≤—ã–±–æ—Ä == "4":
            try:
                enrollment_id = int(input("–í–≤–µ–¥–∏—Ç–µ ID –∑–∞–ø–∏—Å–∏: "))
                grade = float(input("–í–≤–µ–¥–∏—Ç–µ –æ—Ü–µ–Ω–∫—É (–æ—Ç 0 –¥–æ 100): "))
                if 0 <= grade <= 100:
                    set_grade(enrollment_id, grade)
                    print(f"‚úÖ –û—Ü–µ–Ω–∫–∞ {grade} —É—Å–ø–µ—à–Ω–æ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∞.")
                else:
                    print("‚ùå –û—Ü–µ–Ω–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 0 –¥–æ 100!")
            except ValueError:
                print("‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –≤–≤–æ–¥!")

        elif –≤—ã–±–æ—Ä == "5":
            —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å = get_student_performance()
            print("\nüåü –£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:")
            if —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å:
                for name, avg in —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å:
                    print(f"{name}: {avg:.2f}")
            else:
                print("‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö.")

        elif –≤—ã–±–æ—Ä == "6":
            print("üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
            break

        else:
            print("‚ö†Ô∏è –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")


if __name__ == "__main__":
    print("üåê –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã...")
    print("1. –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å")
    print("2. –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (CLI)")
    —Ä–µ–∂–∏–º = input("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (1 –∏–ª–∏ 2): ").strip()

    if —Ä–µ–∂–∏–º == "1":
        main_menu()
    elif —Ä–µ–∂–∏–º == "2":
        cli_menu()
    else:
        print("‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ–∂–∏–º. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã.")
